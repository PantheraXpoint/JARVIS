{
  "content_array": [
    "**STAGE 2: MODEL SELECTION**",
    "",
    "Given that you have already figured out the optimal task list in Stage 1, now keep that in mind to choose models for each task in your pipeline.",
    "",
    "**UNDERSTANDING MODEL FIELDS**:",
    "",
    "Each model above has several key fields that describe its capabilities and characteristics:",
    "",
    "1. **id** (string): This is the unique identifier for the model. You must return this exact ID in your selection.",
    "",
    "2. **name** (string): This is a human-readable name that describes the model and its architecture (e.g., 'RetinaFace ResNet50', 'YOLOv8 Large').",
    "",
    "3. **description** (string): This provides detailed information about what the model does, its training data, its strengths, and its intended use cases. Pay close attention to this field as it often contains critical information about when the model should or shouldn't be used.",
    "",
    "**SELECTION CRITERIA**:",
    "",
    "When selecting a model, consider the following factors:",
    "",
    "1. **Scenario Context**: The scenario description provides important context about the environment, objects present, and any special conditions (emergency, normal operation, etc.). Choose a model that is appropriate for this context.",
    "",
    "2. **Task Requirements**: The task has specific input and output requirements. Ensure the model you select is designed to handle the task's inputs and produce the expected outputs.",
    "",
    "3. **Model Capabilities**: Based on the model descriptions, determine which model has the capabilities best suited for the scenario. Consider factors like:",
    "   - Accuracy vs Speed tradeoffs",
    "   - Robustness to different conditions (lighting, occlusion, etc.)",
    "   - Specialization for certain object types or scenarios",
    "   - Known strengths and limitations",
    "",
    "4. **Description Alignment**: If a model's description explicitly mentions suitability for certain scenarios or object types mentioned in the scenario description, that's a strong indicator it may be the right choice.",
    "",
    "**AVAILABLE MODELS FOR ALL TASKS**:",
    "",
    "Below are the available models for each task type. You will need to:",
    "1. Select the relevant tasks for the scenario (from your brainstorming in Stage 1)",
    "2. For each selected task, choose the most suitable model from its available models",
    "3. Output the final result in the required format",
    "",
    "**FINAL OUTPUT REQUIREMENTS**:",
    "",
    "You must now generate the complete output that includes both:",
    "1. The optimal task pipeline (based on your brainstorming in Stage 1)",
    "2. The selected model for each task (from the available models listed above)",
    "",
    "Output format: Return a JSON object with a \"tasks\" array. Each entry in the array must have exactly these fields:",
    "- \"id\": The task ID (from your Stage 1 task pipeline)",
    "- \"model_id\": The selected model ID (or \"none\" for source/pipeline-end tasks)",
    "- \"inputs_from_upstreams\": Array of input types",
    "- \"upstreams\": Array of upstream task IDs",
    "- \"outputs_for_downstreams\": Array of output types",
    "- \"downstreams\": Array of downstream task IDs",
    "- \"model-chosen-reason\": Explanation for model selection (or reason why no model needed)",
    "- \"sample-reasoning\": Object with keys from downstreams array, explaining task selection reasoning. Each value must be a detailed explanation that:",
    "  * References specific parts of the scenario description",
    "  * Explains WHY you chose this downstream task",
    "  * Explains why you excluded other possible downstream tasks (if applicable)",
    "  * Demonstrates understanding of the scenario context",
    "  * Do NOT use placeholder text like \"Reason for selecting this downstream task\" - provide actual detailed reasoning",
    "",
    "Example output format (with proper sample-reasoning):",
    "{",
    "  \"tasks\": [",
    "    {",
    "      \"id\": \"source\",",
    "      \"model_id\": \"none\",",
    "      \"inputs_from_upstreams\": [\"none\"],",
    "      \"upstreams\": [\"none\"],",
    "      \"outputs_for_downstreams\": [\"image\"],",
    "      \"downstreams\": [\"object-detection-general\"],",
    "      \"model-chosen-reason\": \"Source task doesn't need a model\",",
    "      \"sample-reasoning\": {\"object-detection-general\": \"Since the scenario mentions fire, object detection is crucial to identify all objects in the scene, including people and fire-related objects, for safety and emergency response.\"}",
    "    },",
    "    {",
    "      \"id\": \"object-detection-general\",",
    "      \"model_id\": \"yolov5m\",",
    "      \"inputs_from_upstreams\": [\"image\"],",
    "      \"upstreams\": [\"source\"],",
    "      \"outputs_for_downstreams\": [\"bounding boxes\"],",
    "      \"downstreams\": [\"face-detection\", \"fire-detection\"],",
    "      \"model-chosen-reason\": \"YOLOv5m provides good balance of speed and accuracy for detecting objects in emergency scenarios\",",
    "      \"sample-reasoning\": {",
    "        \"face-detection\": \"Since the scenario involves people in a fire emergency, detecting faces is important for identifying individuals and ensuring their safety during evacuation.\",",
    "        \"fire-detection\": \"Since the scenario explicitly mentions fire, fire detection is crucial to identify and localize the fire for emergency response and safety measures.\"",
    "      }",
    "    }",
    "    // ... more tasks",
    "  ]",
    "}",
    "",
    "IMPORTANT:",
    "- Include ALL tasks in your pipeline (source, processing tasks, pipeline-end)",
    "- For each task, select the most suitable model from its available models",
    "- Ensure proper dependencies and data flow",
    "- The \"sample-reasoning\" field is CRITICAL - it must contain detailed, meaningful explanations for each downstream task, referencing specific aspects of the scenario description. Do NOT use generic placeholder text.",
    "- Look at the few-shot examples above to see how sample-reasoning should be written - they contain detailed explanations that reference the scenario context",
    "- Output ONLY the JSON object, no additional text or markdown formatting"
  ]
}

